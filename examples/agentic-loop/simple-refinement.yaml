# Simple Agentic Loop Example - Iterative Code Implementation
# Usage: echo "Write a function to validate email addresses" | comanda process examples/agentic-loop/simple-refinement.yaml
#
# This example shows the inline agentic loop syntax for a programming task.
# The loop will iterate up to 3 times, refining the implementation each iteration.
# When the model is satisfied with the code quality, it outputs SATISFIED to exit.

implement:
  agentic_loop:
    max_iterations: 3
    exit_condition: pattern_match
    exit_pattern: "SATISFIED"
  input: STDIN
  model: claude-code
  action: |
    You are iteratively implementing code. This is iteration {{ loop.iteration }}.

    Your previous implementation:
    {{ loop.previous_output }}

    Review and improve the code:
    - Add error handling if missing
    - Add edge case handling
    - Improve code clarity and documentation

    If the implementation is complete and production-ready,
    start your response with exactly: SATISFIED

    Then output the final code.
  output: STDOUT
